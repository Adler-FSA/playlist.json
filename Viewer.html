<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>üåê FSA Global Viewer</title>
  <style>
    body{font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;
         margin:0;background:#fff;color:#111;padding:16px}
    h2{margin-top:0}
    h3{margin-top:24px;margin-bottom:8px}
    .item{margin:12px 0;padding:8px;border:1px solid #ddd;
          border-radius:6px;background:#fafafa}
    iframe{width:100%;height:280px;border:none;border-radius:6px}
    audio{width:100%;margin-top:6px}
    .ok{color:#15803d;font-weight:700}
    .err{color:#b91c1c;font-weight:700}
  </style>
</head>
<body>
  <h2>üåê Globale Playlist</h2>
  <div id="msg">Lade‚Ä¶</div>

  <h3>üî¥ Live-Event</h3>
  <div id="live"></div>

  <h3>üì∫ Videos</h3>
  <div id="v"></div>

  <h3>üéµ Musik</h3>
  <div id="m"></div>
  <audio id="aud" controls></audio>

  <script>
  (async function(){
    const URL="https://adler-fsa.github.io/playlist.json/playlist.json";
    function esc(s){return (s||"").replace(/[&<>]/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;'}[c]))}
    try{
      const r=await fetch(URL+'?nocache='+Date.now(),{cache:'no-store'});
      if(!r.ok) throw new Error('HTTP '+r.status);
      const d=await r.json();
      document.getElementById('msg').textContent='‚úÖ Playlist geladen';
      document.getElementById('msg').className='ok';

      // Live
      if(d.live && d.live.url){
        document.getElementById('live').innerHTML=
          "<div class=item><b>"+esc(d.live.title||'Live-Stream')+"</b><br>"+
          "<iframe src='"+esc(d.live.url)+"' allowfullscreen></iframe></div>";
      }else{
        document.getElementById('live').innerHTML='<em>Kein Live-Event</em>';
      }

      // Videos
      document.getElementById('v').innerHTML=(d.videos||[])
        .map(v=>"<div class=item><b>"+esc(v.title)+"</b><br>"+
          "<iframe src='"+esc(v.url)+"' allowfullscreen></iframe></div>")
        .join('')||'<em>Keine Videos</em>';

      // Musik
      document.getElementById('m').innerHTML=(d.music||[])
        .map(m=>"<div class=item>"+esc(m.title)+
          " <button onclick=\"aud.src='"+esc(m.url)+"';aud.play()\">‚ñ∂Ô∏è</button></div>")
        .join('')||'<em>Keine Musik</em>';

    }catch(e){
      document.getElementById('msg').textContent='‚ùå Fehler: '+e.message;
      document.getElementById('msg').className='err';
    }
  })();
  </script>
</body>
</html>

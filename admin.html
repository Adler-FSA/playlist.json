<!-- ‚öôÔ∏è Admin Panel ‚Äì √úbersicht & Steuerung -->
<div id="fsa-admin" style="font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif; max-width:960px; margin:20px auto; padding:20px; background:#fff; border:1px solid #ddd; border-radius:10px; box-shadow:0 4px 12px rgba(0,0,0,.1);">
  <h2 style="margin:0 0 12px; font-size:1.4rem; color:#111827;">‚öôÔ∏è FSA Admin ‚Äì √úbersicht aller Landingpages</h2>

  <!-- Z√§hler -->
  <div style="padding:12px; background:#f9fafb; border:1px solid #ccc; border-radius:8px; margin-bottom:14px;">
    Gesamt: <strong id="count-total">0</strong> |
    Frei: <strong id="count-free">0</strong> |
    Aktiv: <strong id="count-active">0</strong>
  </div>

  <!-- Tabelle -->
  <table style="width:100%; border-collapse:collapse; font-size:.95rem;">
    <thead>
      <tr style="background:#f3f4f6; text-align:left;">
        <th style="padding:8px; border:1px solid #ddd;">ID</th>
        <th style="padding:8px; border:1px solid #ddd;">Status</th>
        <th style="padding:8px; border:1px solid #ddd;">E-Mail</th>
        <th style="padding:8px; border:1px solid #ddd;">Aktionen</th>
      </tr>
    </thead>
    <tbody id="page-list"></tbody>
  </table>
</div>

<script>
(async function(){
  let config = { pages: {} };
  try {
    const res = await fetch("config.json");
    config = await res.json();
  } catch(e){
    console.warn("‚ö†Ô∏è config.json nicht geladen.");
  }

  const listEl = document.getElementById("page-list");
  const totalEl = document.getElementById("count-total");
  const freeEl = document.getElementById("count-free");
  const activeEl = document.getElementById("count-active");

  function render(){
    let total=0, free=0, active=0;
    const rows = Object.entries(config.pages).map(([id,data])=>{
      total++;
      if(data.status==="frei") free++; else active++;

      return `
        <tr>
          <td style="padding:6px; border:1px solid #ddd;">${id}</td>
          <td style="padding:6px; border:1px solid #ddd; color:${data.status==="frei"?"green":"#2563eb"}; font-weight:bold;">${data.status}</td>
          <td style="padding:6px; border:1px solid #ddd;">
            <input id="mail-${id}" type="email" value="${data.email}" style="width:95%; padding:4px; border:1px solid #bbb; border-radius:4px;">
          </td>
          <td style="padding:6px; border:1px solid #ddd;">
            <button onclick="setEmail('${id}')" style="padding:4px 8px; background:#16a34a; color:#fff; border:none; border-radius:4px; cursor:pointer;">‚úÖ Speichern</button>
            <button onclick="resetPage('${id}')" style="padding:4px 8px; background:#e11d48; color:#fff; border:none; border-radius:4px; cursor:pointer;">üè≠ Reset</button>
          </td>
        </tr>
      `;
    });

    listEl.innerHTML = rows.join("");
    totalEl.textContent = total;
    freeEl.textContent = free;
    activeEl.textContent = active;
  }

  // Aktionen
  window.setEmail = function(id){
    const mail = document.getElementById("mail-"+id).value.trim();
    if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(mail)){
      alert("‚ö†Ô∏è Ung√ºltige E-Mail.");
      return;
    }
    config.pages[id].email = mail;
    config.pages[id].status = "aktiv";
    render();
    alert("‚úÖ E-Mail aktualisiert f√ºr " + id);
  };

  window.resetPage = function(id){
    config.pages[id].email = "platzhalter@email.de";
    config.pages[id].status = "frei";
    render();
    alert("‚ôªÔ∏è Seite zur√ºckgesetzt auf Werkseinstellung: " + id);
  };

  render();
})();
</script>
